<div class="grid">
    <div class="col-12 pt-0">
        <input pInputText type="text" [(ngModel)]="currentLocation" placeholder="Ubicación Actual" class="mr-2" style="min-width: 40vw;" disabled>
        <button pButton pRipple (click)="setCurrentLocation()" class="mr-2" icon="fa-solid fa-location-arrow" styleClass="p-button-secondary"></button>
        <button pButton pRipple (click)="buscarAutos()" label="Buscar Autos Cercanos" class="mr-2" icon="fa-solid fa-car-side" styleClass="p-button-secondary"></button>
    </div>
    <div class="col-12">
        <input pInputText type="text" id="searchTextField" [(ngModel)]="toLocation" placeholder="Destino" class="mr-2" style="min-width: 40vw;">
        <p-calendar [(ngModel)]="date" [showIcon]="true" class="mr-2"></p-calendar>
        <p-calendar [(ngModel)]="time" [showIcon]="true" class="mr-2" icon="pi pi-clock" [timeOnly]="true" [showSeconds]="false"></p-calendar>
        <button pButton pRipple (click)="calcularRuta()" label="Calcular Ruta" class="mr-2" icon="fa-solid fa-route" styleClass="p-button-secondary"></button>
        <button pButton pRipple (click)="pagarViaje()" label="Método de Pago" class="mr-2" icon="fa-solid fa-money-check" styleClass="p-button-secondary"></button>
    </div>
    <div class="col-12">
        <div *ngIf="apiLoaded | async">
            <google-map [options]="options">
                <map-marker *ngFor="let markerPosition of markerPositions" [position]="markerPosition"
                    [options]="markerOptions"></map-marker>
                <map-marker *ngFor="let markerCarPosition of markerCars" [position]="markerCarPosition"
                    [options]="markerCarsOptions" (mapClick)="handleMarkerClick(location)"></map-marker>
                <map-directions-renderer *ngIf="(directionsResults$ | async) as directionsResults"
                    [directions]="directionsResults"></map-directions-renderer>

                <!-- <map-directions-renderer [directions]="directionsResults"></map-directions-renderer> -->
            </google-map>
        </div>
    </div>
</div>


<p-dialog header="Método de Pago" [(visible)]="display" modal="modal" showEffect="fade" [style]="{width: '30vw'}" [breakpoints]="{'960px': '75vw'}">
    <div class="grid p-fluid mt-3">
        <div class="col-12">

            <p-listbox [options]="paymentMethods" [(ngModel)]="payment.type" optionLabel="name" [listStyle]="{ 'max-height': '250px' }" [style]="{ width: '15rem' }">
                <ng-template let-payment pTemplate="item">
                    <div class="flex align-items-center gap-2">
                        <i [class]="payment.icon"></i>
                        <div>{{ payment.label }}</div>
                    </div>
                </ng-template>
            </p-listbox>
        </div>
        <div class="field col-12 md:col-6">
            <span class="p-float-label">
                <input type="text" pInputText [(ngModel)]="payment.name">
                <label>Nombre</label>
            </span>
        </div>
        <div class="field col-12 md:col-6">
            <span class="p-float-label">
                <input type="text" pInputText [(ngModel)]="payment.lastName">
                <label>Apellido</label>
            </span>
        </div>
        <div class="field col-12">
            <span class="p-float-label">
                <p-inputMask mask="9999 9999 9999 9999" [(ngModel)]="payment.creditcard"></p-inputMask>
                <label>Tarjeta</label>
            </span>
        </div>
        <div class="field col-12 md:col-8">
            <span class="p-float-label">
                <p-calendar view="month" dateFormat="mm/yy" [(ngModel)]="payment.expirationDate" appendTo="body"></p-calendar>
                <label>Fecha Exp</label>
            </span>
        </div>
        <div class="field col-12 md:col-4">
            <span class="p-float-label">
                <p-inputMask mask="999" [(ngModel)]="payment.pin"></p-inputMask>
                <label>PIN</label>
            </span>
        </div>
    </div>
    <ng-template pTemplate="footer">
            <button pButton icon="pi pi-check" (click)="display=false" label="Ok" class="p-button-outlined"></button>
    </ng-template>
</p-dialog>
